<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>QT5.15.2连接MySQL8.0.40</title>
      <link href="/posts/3b2ae34c.html"/>
      <url>/posts/3b2ae34c.html</url>
      
        <content type="html"><![CDATA[<h1 id="QT5-15-2连接MySQL8-0-40详细教程"><a href="#QT5-15-2连接MySQL8-0-40详细教程" class="headerlink" title="QT5.15.2连接MySQL8.0.40详细教程"></a>QT5.15.2连接MySQL8.0.40详细教程</h1><h2 id="1-环境准备"><a href="#1-环境准备" class="headerlink" title="1. 环境准备"></a>1. 环境准备</h2><ul><li>操作系统：Windows 10</li><li>Qt版本：5.15.2（建议使用官方MSVC或MinGW版本）</li><li>MySQL版本：8.0.40（建议安装完整MySQL Server，记住root密码）</li><li>C++编译器：与Qt版本一致（MSVC或MinGW）</li></ul><h2 id="2-安装MySQL"><a href="#2-安装MySQL" class="headerlink" title="2. 安装MySQL"></a>2. 安装MySQL</h2><ol><li>前往<a href="https://dev.mysql.com/downloads/mysql/">MySQL官网</a>下载并安装MySQL 8.0.40。</li><li>安装过程中设置root密码，记住端口号（默认3306）。</li><li>安装完成后，记下MySQL的安装目录（如：<code>D:\Program Files\MySQL\MySQL Server 8.0</code>）。</li></ol><h2 id="3-配置环境变量"><a href="#3-配置环境变量" class="headerlink" title="3. 配置环境变量"></a>3. 配置环境变量</h2><p>将MySQL的bin目录添加到系统环境变量Path中，例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\Program Files\MySQL\MySQL Server 8.0\bin</span><br></pre></td></tr></table></figure><h2 id="4-编译MySQL驱动（QMYSQL）"><a href="#4-编译MySQL驱动（QMYSQL）" class="headerlink" title="4. 编译MySQL驱动（QMYSQL）"></a>4. 编译MySQL驱动（QMYSQL）</h2><p>Qt5.12之后的版本自带的MySQL驱动通常未编译，需要手动编译。</p><h3 id="4-1-找到Qt的源码（需要下载QT源码）"><a href="#4-1-找到Qt的源码（需要下载QT源码）" class="headerlink" title="4.1 找到Qt的源码（需要下载QT源码）"></a>4.1 找到Qt的源码（需要下载QT源码）</h3><p>在“QT维护工具(<code>Qt Maintenance Tool</code>)”中下载Sources(如果已经下载忽略这一步骤);</p><p>然后进入<code>D:\QT\5.15.2\Src\qtbase\src\plugins\sqldrivers\psql</code>运行<code>mysql.pro</code>文件</p><h3 id="4-2-修改项目工程"><a href="#4-2-修改项目工程" class="headerlink" title="4.2 修改项目工程"></a>4.2 修改项目工程</h3><ul><li>在<code>mysql.pro</code>中，将语句QMAKE_USE+&#x3D;mysql注释掉，并添加两行新语句：</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INCLUDEPATH += D:\Program Files\MySQL\MySQL Server 8.0\include</span><br><span class="line">LIBS += D:\Program Files\MySQL\MySQL Server 8.0\lib\libmysql.lib</span><br></pre></td></tr></table></figure><ul><li><p>在 <code>qsqldriverbase.pri</code> 中，将语句 <code>include($$shadowed($$PWD)/qtsqldrivers-config.pri)</code>注释掉</p><p>并添加一行新语句：<code>include(./configure.pri)</code></p></li></ul><h3 id="4-3编译"><a href="#4-3编译" class="headerlink" title="4.3编译"></a>4.3编译</h3><p>在<code>QTCreator</code>中打开<code>mysql.pro</code>文件，点击构建；</p><p>然后在<code>D:\QT\5.15.2\Src\qtbase\src\plugins\sqldrivers\mysql\lib</code>中有编译好的驱动。</p><h3 id="4-4-拷贝驱动"><a href="#4-4-拷贝驱动" class="headerlink" title="4.4 拷贝驱动"></a>4.4 拷贝驱动</h3><p>编译成功后，会生成<code>qsqlmysql.dll、qsqlmysql.dll.debug</code>，将其复制到：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\QT\5.15.2\mingw81_64\plugins\sqldrivers(根据自己的路径)</span><br></pre></td></tr></table></figure><p>将生成的<code>libqsqlmysql.a</code>复制到：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\CodeSoftware\QT\5.15.2\mingw81_64\lib</span><br></pre></td></tr></table></figure><h2 id="5-配置MySQL动态库"><a href="#5-配置MySQL动态库" class="headerlink" title="5. 配置MySQL动态库"></a>5. 配置MySQL动态库</h2><p>将<code>libmysql.dll</code>（MySQL安装目录下的lib目录<code>D:\Program Files\MySQL\MySQL Server 8.0\lib</code>）复制到:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\QT\5.15.2\mingw81_64\bin</span><br></pre></td></tr></table></figure><h2 id="6-Qt代码示例"><a href="#6-Qt代码示例" class="headerlink" title="6. Qt代码示例"></a>6. Qt代码示例</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QCoreApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QtSql&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QCoreApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line"></span><br><span class="line">    QSqlDatabase db = QSqlDatabase::<span class="built_in">addDatabase</span>(<span class="string">&quot;QMYSQL&quot;</span>);</span><br><span class="line">    db.<span class="built_in">setHostName</span>(<span class="string">&quot;localhost&quot;</span>);</span><br><span class="line">    db.<span class="built_in">setPort</span>(<span class="number">3306</span>);</span><br><span class="line">    db.<span class="built_in">setDatabaseName</span>(<span class="string">&quot;testdb&quot;</span>); <span class="comment">// 你的数据库名</span></span><br><span class="line">    db.<span class="built_in">setUserName</span>(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">    db.<span class="built_in">setPassword</span>(<span class="string">&quot;你的密码&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!db.<span class="built_in">open</span>()) &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;数据库连接失败：&quot;</span> &lt;&lt; db.<span class="built_in">lastError</span>().<span class="built_in">text</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;数据库连接成功！&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查询示例</span></span><br><span class="line">    <span class="function">QSqlQuery <span class="title">query</span><span class="params">(<span class="string">&quot;SELECT * FROM your_table&quot;</span>)</span></span>;</span><br><span class="line">    <span class="keyword">while</span> (query.<span class="built_in">next</span>()) &#123;</span><br><span class="line">        QString value = query.<span class="built_in">value</span>(<span class="number">0</span>).<span class="built_in">toString</span>();</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    db.<span class="built_in">close</span>();</span><br><span class="line">    <span class="keyword">return</span> a.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="7-常见问题与解决"><a href="#7-常见问题与解决" class="headerlink" title="7. 常见问题与解决"></a>7. 常见问题与解决</h2><ul><li><p><strong>QSqlDatabase: QMYSQL driver not loaded</strong></p><ul><li>检查<code>qsqlmysql.dll</code>是否在<code>plugins/sqldrivers</code>目录下。</li><li>检查<code>libmysql.dll</code>是否在可执行文件同目录或Path路径下。</li><li>驱动编译时INCLUDEPATH和LIBS路径是否正确。</li></ul></li><li><p><strong>无法连接数据库</strong></p><ul><li>检查MySQL服务是否启动。</li><li>检查用户名、密码、端口、数据库名是否正确。</li><li>检查防火墙设置。</li></ul></li></ul><h2 id="8-参考资料"><a href="#8-参考资料" class="headerlink" title="8. 参考资料"></a>8. 参考资料</h2><ul><li><a href="https://doc.qt.io/qt-5/sql-driver.html">Qt官方文档 - SQL Database Drivers</a></li><li><a href="https://dev.mysql.com/doc/">MySQL官方文档</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> QT(C++) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> QT连接数据库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/posts/4a17b156.html"/>
      <url>/posts/4a17b156.html</url>
      
        <content type="html"><![CDATA[<p>It’s a pleasure to meet you.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hello world&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
